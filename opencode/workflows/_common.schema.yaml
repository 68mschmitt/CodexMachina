$schema: http://json-schema.org/draft-07/schema#
title: OpenCode Workflow Specification
description: Schema for validating workflow YAML specifications

type: object
required:
  - name
  - version
  - agents
  - tools

properties:
  name:
    type: string
    description: Workflow name (kebab-case)
    pattern: ^[a-z0-9]+(_[a-z0-9]+)*$

  version:
    type: integer
    description: Workflow schema version

  description:
    type: string
    description: Human-readable description

  inputs:
    type: array
    items:
      type: string
    description: Input files/artifacts required

  outputs:
    type: array
    items:
      type: string
    description: Output files/artifacts produced

  agents:
    type: array
    items:
      type: object
      required:
        - use
      properties:
        use:
          type: string
          description: Agent name to invoke

        config:
          type: object
          description: Agent-specific configuration overrides

  tools:
    type: array
    items:
      type: string
    description: Tools available in this workflow

  preset:
    type: string
    description: Preset name or path to preset YAML

  gates:
    type: array
    items:
      oneOf:
        - type: string
        - type: object
    description: Quality gates to apply

  context:
    type: object
    description: Static context packs to load

  variables:
    type: object
    description: Workflow variables and defaults

additionalProperties: true
